syntax = "proto2";

package protocol;

enum ApkType {
    APP = 0;
    WATCH_FACE = 1;
}

enum InstallCode {
    VERSION_DOWNGRADE = 0;
    LATEST_VERSION = 1;
    APK_NOT_FOUND = 2;
    WAITING_DOWNLOAD = 3;
    DOWNLOADING = 4;
    DOWNLOAD_FAILED = 5;
    INSTALLING = 6;
    INSTALL_SUCCESS = 7;
    INSTALL_FAILED = 8;
    CANCELLED = 9;
}

message Market {

    enum MarketID {
        TRY_INSTALL_APK = 0;
        TRY_INSTALL_APKS = 1;
        REPORT_INSTALL_PROGRESS = 2;
        TRY_INSTALL_APK_NEW = 3;
        TRY_INSTALL_APKS_NEW = 4;
        SEND_PHONE_MESSAGE = 5;
        SEND_WEAR_MESSAGE = 6;
    }

    oneof payload {
        Apk apk = 1;
        Apk.List apk_list = 2;
        InstallProgress install_progress = 3;
        MarketMessage market_message = 4;
    }
}

message Apk {

    message List {
        repeated Apk list = 1;
    }

    required ApkType type = 1;
    oneof payload {
        string package_name = 2;
        string url = 3;
        ApkInfo apk_info = 4;
    }
}

message ApkInfo {
    required string package_name = 1;
    required string package_hash = 2;
    required uint64 version_code = 3;
}

message InstallProgress {
    required InstallCode code = 1;
    required string package_name = 2;
    optional uint32 download_progress = 3;
}

message MarketMessage {
    required bytes content = 1;
}